
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../capstone_paper/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Capstone Analysis - Kevin Zheng's Code Portfolio</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#capstone-analysis" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Kevin Zheng&#39;s Code Portfolio" class="md-header__button md-logo" aria-label="Kevin Zheng's Code Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Kevin Zheng's Code Portfolio
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Capstone Analysis
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Code Portfolio

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Capstone Analysis

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../capstone_paper/" class="md-tabs__link">
        
  
    
  
  Capstone Paper

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../methods_report/" class="md-tabs__link">
        
  
    
  
  Methods Report

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../scripts/" class="md-tabs__link">
        
  
    
  
  Miscellaneous Scripts

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Kevin Zheng&#39;s Code Portfolio" class="md-nav__button md-logo" aria-label="Kevin Zheng's Code Portfolio" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Kevin Zheng's Code Portfolio
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code Portfolio
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Capstone Analysis
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Capstone Analysis
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-load-required-libraries-r" class="md-nav__link">
    <span class="md-ellipsis">
      1. Load required libraries (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-multiple-imputation-r" class="md-nav__link">
    <span class="md-ellipsis">
      2. Multiple Imputation (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#make-table-1-r" class="md-nav__link">
    <span class="md-ellipsis">
      Make table 1 (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#read-in-data-and-set-up-variables-r" class="md-nav__link">
    <span class="md-ellipsis">
      Read in data and set up variables (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-k-fold-5-cross-validated-cox-proportional-hazards-r" class="md-nav__link">
    <span class="md-ellipsis">
      Run K-fold (5) cross validated cox proportional hazards (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sensitivity-analysis-excluding-missing-values-r" class="md-nav__link">
    <span class="md-ellipsis">
      Sensitivity analysis excluding missing values (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#time-dependent-roc-sas-proc-phreg-procedure" class="md-nav__link">
    <span class="md-ellipsis">
      Time-Dependent ROC (SAS PROC PHREG procedure)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-pairwise-comparisons-r" class="md-nav__link">
    <span class="md-ellipsis">
      6 Pairwise comparisons (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#anova-test-for-interactions-r" class="md-nav__link">
    <span class="md-ellipsis">
      ANOVA test for interactions (R)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#subgroup-analysis-r" class="md-nav__link">
    <span class="md-ellipsis">
      Subgroup analysis (R)
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../capstone_paper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Capstone Paper
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../methods_report/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Methods Report
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../scripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous Scripts
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<div><h1 id="capstone-analysis">Capstone Analysis</h1>
<h2 id="1-load-required-libraries-r">1. Load required libraries (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>library(table1)
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>library(survival)  
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>library(cvTools)   
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>library(tidyverse)
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>library(risksetROC)
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>library(pROC)
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>library(timeROC)
</code></pre></div>
<h2 id="2-multiple-imputation-r">2. Multiple Imputation (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>#print num of NA in each var
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>x &lt;- df %&gt;% summarize_all(funs(sum(is.na(.))))
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>x
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>length(df$FTV3)
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>library(dplyr)
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>library(tidyr)
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>result &lt;- df %&gt;% summarize_all(funs(sum(is.na(.)))) %&gt;%
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>  gather(key = "variable", value = "missing count") %&gt;%
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>  arrange(variable)
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>result
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>#imputation easy way: mean and median
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>#df$FTV0[is.na[df$FTV0]] &lt;- mean(df$FTV0, na.rm = T)
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>#visualize NA
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>colnames(df[,25:28])
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>md.pattern(df[,25:28])
<a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a>md.pattern(df[,1:35])
<a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a>png("/path/NA_plot.png")
<a id="__codelineno-1-22" name="__codelineno-1-22" href="#__codelineno-1-22"></a>md.pattern(df)
<a id="__codelineno-1-23" name="__codelineno-1-23" href="#__codelineno-1-23"></a>#dev.off()
<a id="__codelineno-1-24" name="__codelineno-1-24" href="#__codelineno-1-24"></a>
<a id="__codelineno-1-25" name="__codelineno-1-25" href="#__codelineno-1-25"></a>#flag variables with NAs
<a id="__codelineno-1-26" name="__codelineno-1-26" href="#__codelineno-1-26"></a>#columns 15, 16, 25:28
<a id="__codelineno-1-27" name="__codelineno-1-27" href="#__codelineno-1-27"></a>#time to local, time to distant, ftv 0-3. columns 16 and 17 are mostly NAs.
<a id="__codelineno-1-28" name="__codelineno-1-28" href="#__codelineno-1-28"></a>colnames(df)
<a id="__codelineno-1-29" name="__codelineno-1-29" href="#__codelineno-1-29"></a>
<a id="__codelineno-1-30" name="__codelineno-1-30" href="#__codelineno-1-30"></a>#subset variables
<a id="__codelineno-1-31" name="__codelineno-1-31" href="#__codelineno-1-31"></a>df_copy &lt;- df[, c(1,7,8,13,17:36)]
<a id="__codelineno-1-32" name="__codelineno-1-32" href="#__codelineno-1-32"></a>colnames(df_copy)
<a id="__codelineno-1-33" name="__codelineno-1-33" href="#__codelineno-1-33"></a>
<a id="__codelineno-1-34" name="__codelineno-1-34" href="#__codelineno-1-34"></a>imputed_data_copy &lt;- mice(df_copy, m = 10, maxit = 30, method = "pmm")
<a id="__codelineno-1-35" name="__codelineno-1-35" href="#__codelineno-1-35"></a>imputed_data_plot &lt;- plot(imputed_data_copy)
<a id="__codelineno-1-36" name="__codelineno-1-36" href="#__codelineno-1-36"></a>
<a id="__codelineno-1-37" name="__codelineno-1-37" href="#__codelineno-1-37"></a>#save plot
<a id="__codelineno-1-38" name="__codelineno-1-38" href="#__codelineno-1-38"></a>pdf("imputed_data_plot.pdf")
<a id="__codelineno-1-39" name="__codelineno-1-39" href="#__codelineno-1-39"></a>print(imputed_data_plot)
<a id="__codelineno-1-40" name="__codelineno-1-40" href="#__codelineno-1-40"></a>dev.off()
<a id="__codelineno-1-41" name="__codelineno-1-41" href="#__codelineno-1-41"></a>
<a id="__codelineno-1-42" name="__codelineno-1-42" href="#__codelineno-1-42"></a>#check values of imputed data
<a id="__codelineno-1-43" name="__codelineno-1-43" href="#__codelineno-1-43"></a>imputed_data_copy$imp$FTV0
<a id="__codelineno-1-44" name="__codelineno-1-44" href="#__codelineno-1-44"></a>str(imputed_data_copy)
<a id="__codelineno-1-45" name="__codelineno-1-45" href="#__codelineno-1-45"></a>
<a id="__codelineno-1-46" name="__codelineno-1-46" href="#__codelineno-1-46"></a>#pool imputed dataset
<a id="__codelineno-1-47" name="__codelineno-1-47" href="#__codelineno-1-47"></a>df &lt;- complete(imputed_data_copy)
<a id="__codelineno-1-48" name="__codelineno-1-48" href="#__codelineno-1-48"></a>df %&gt;% summarize_all(funs(sum(is.na(.))))
<a id="__codelineno-1-49" name="__codelineno-1-49" href="#__codelineno-1-49"></a>str(df)
<a id="__codelineno-1-50" name="__codelineno-1-50" href="#__codelineno-1-50"></a>colnames(df)
</code></pre></div>
<h2 id="make-table-1-r">Make table 1 (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>df &lt;- read.csv("/path/cleaned_imputed_df.csv")
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>colnames(df)
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>#change efs time to years
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>df$efs.time.years &lt;- (df$efs.time)/365.25 
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>#log transformed ftv3
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>df$log_FTV3 &lt;- log(df$FTV3+1)
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>#cube root ftv3
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>df$cube_FTV3 &lt;- df$FTV3^(1/3)
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>#combined status
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>df$combined_status &lt;- ifelse(df$HR == 1 &amp; df$HER2 == 1, "HR+/HER2+",
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>                          ifelse(df$HR == 1, "HR+/HER2-",
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>                          ifelse(df$HER2 == 1, "HR-/HER2+", "HR-/HER2-")))
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>#make factor vars
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>df$HR &lt;- as.factor(df$HR)
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>df$HER2 &lt;- as.factor(df$HER2)
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>df$combined_status &lt;- as.factor(df$combined_status)
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>df$Race &lt;- as.factor(df$Race)
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>df$efs.ind &lt;- as.factor(df$efs.ind)
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>df$menopausal_status &lt;- as.factor(df$menopausal_status)
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>df$Arm &lt;- as.factor(df$Arm)
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>df$pCR &lt;- as.factor(df$pCR)
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>df$ethnicity &lt;- as.factor(df$ethnicity)
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>colnames(df)
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>
<a id="__codelineno-2-31" name="__codelineno-2-31" href="#__codelineno-2-31"></a>tab1 &lt;- table1(~Age_at_Screening + Race + ethnicity + Arm + pCR + 
<a id="__codelineno-2-32" name="__codelineno-2-32" href="#__codelineno-2-32"></a>        menopausal_status + combined_status + efs.time + efs.ind, data = df)
<a id="__codelineno-2-33" name="__codelineno-2-33" href="#__codelineno-2-33"></a>
<a id="__codelineno-2-34" name="__codelineno-2-34" href="#__codelineno-2-34"></a>tab1
</code></pre></div>
<h2 id="read-in-data-and-set-up-variables-r">Read in data and set up variables (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>df &lt;- read.csv("/path/cleaned_imputed_df_2.csv")
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>colnames(df)
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>#change efs time to years
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>df$efs.time.years &lt;- (df$efs.time)/365.25 
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>#log transformed ftv3
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>df$log_FTV3 &lt;- log(df$FTV3+1)
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>#cube root ftv3
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>df$cube_FTV3 &lt;- df$FTV3^(1/3)
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>#combined status
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>df$combined_status &lt;- ifelse(df$HR == 1 &amp; df$HER2 == 1, "HR+/HER2+",
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>                          ifelse(df$HR == 1, "HR+/HER2-",
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>                          ifelse(df$HER2 == 1, "HR-/HER2+", "HR-/HER2-")))
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>#make factor vars
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>df$HR &lt;- as.factor(df$HR)
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>df$HER2 &lt;- as.factor(df$HER2)
<a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>df$combined_status &lt;- as.factor(df$combined_status)
</code></pre></div>
<h2 id="run-k-fold-5-cross-validated-cox-proportional-hazards-r">Run K-fold (5) cross validated cox proportional hazards (R)</h2>
<p>We use 3 models with differing forms of FTV3, with concordance index as the evaluation metric. Efs.time is the time variable, and Efs.ind is the indicator variable. We choose the best model based on the highest cross validated concordance index.
</p><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>set.seed(123456)
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>#make lists of predictor sets
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>predictor_lists &lt;- list(
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>  c("FTV3", "combined_status"),
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>  c("log_FTV3", "combined_status"),
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>  c("cube_FTV3", "combined_status")
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>)
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>#set number of folds for cross-validation
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>num_folds &lt;- 5
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>#create folds
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>folds &lt;- cvFolds(nrow(df), K = num_folds, type = "random")
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>#initialize a list to store concordance indices for each model
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>c_indices_list &lt;- vector("list", length(predictor_lists))
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>#cross-validation func
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>for(j in seq_along(predictor_lists)){
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>  c_indices &lt;- numeric(num_folds)
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>  for(i in 1:num_folds){
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>    #split the data into train/test sets for this fold
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>    train_indices &lt;- folds$subsets[folds$which != i]
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a>    test_indices &lt;- folds$subsets[folds$which == i]
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a>    df_train_fold &lt;- df[train_indices, ]
<a id="__codelineno-4-26" name="__codelineno-4-26" href="#__codelineno-4-26"></a>    df_test_fold &lt;- df[test_indices, ]
<a id="__codelineno-4-27" name="__codelineno-4-27" href="#__codelineno-4-27"></a>
<a id="__codelineno-4-28" name="__codelineno-4-28" href="#__codelineno-4-28"></a>    #fit cox model on training
<a id="__codelineno-4-29" name="__codelineno-4-29" href="#__codelineno-4-29"></a>    cox &lt;- coxph(as.formula(paste("Surv(efs.time, efs.ind) ~", 
<a id="__codelineno-4-30" name="__codelineno-4-30" href="#__codelineno-4-30"></a>                 paste(predictor_lists[[j]], collapse = " + "))), data = df_train_fold)
<a id="__codelineno-4-31" name="__codelineno-4-31" href="#__codelineno-4-31"></a>
<a id="__codelineno-4-32" name="__codelineno-4-32" href="#__codelineno-4-32"></a>    #calculate concordance index
<a id="__codelineno-4-33" name="__codelineno-4-33" href="#__codelineno-4-33"></a>    c_indices[i] &lt;- concordance(cox, newdata = df_test_fold)
<a id="__codelineno-4-34" name="__codelineno-4-34" href="#__codelineno-4-34"></a>  }
<a id="__codelineno-4-35" name="__codelineno-4-35" href="#__codelineno-4-35"></a>  #store concordance indices for this model
<a id="__codelineno-4-36" name="__codelineno-4-36" href="#__codelineno-4-36"></a>  c_indices_list[[j]] &lt;- list(c_indices)
<a id="__codelineno-4-37" name="__codelineno-4-37" href="#__codelineno-4-37"></a>}
<a id="__codelineno-4-38" name="__codelineno-4-38" href="#__codelineno-4-38"></a>
<a id="__codelineno-4-39" name="__codelineno-4-39" href="#__codelineno-4-39"></a>#calculate mean concordance index across all folds for each model
<a id="__codelineno-4-40" name="__codelineno-4-40" href="#__codelineno-4-40"></a>mean_concordance_list &lt;- sapply(c_indices_list, function(x) mean(unlist(x)))
<a id="__codelineno-4-41" name="__codelineno-4-41" href="#__codelineno-4-41"></a>mean_concordance_list
<a id="__codelineno-4-42" name="__codelineno-4-42" href="#__codelineno-4-42"></a>
<a id="__codelineno-4-43" name="__codelineno-4-43" href="#__codelineno-4-43"></a>#find the best model based on cv
<a id="__codelineno-4-44" name="__codelineno-4-44" href="#__codelineno-4-44"></a>best_model_index &lt;- which.max(mean_concordance_list)
<a id="__codelineno-4-45" name="__codelineno-4-45" href="#__codelineno-4-45"></a>best_model_predictors &lt;- predictor_lists[[best_model_index]]
<a id="__codelineno-4-46" name="__codelineno-4-46" href="#__codelineno-4-46"></a>
<a id="__codelineno-4-47" name="__codelineno-4-47" href="#__codelineno-4-47"></a>best_model_predictors
</code></pre></div>
<h2 id="sensitivity-analysis-excluding-missing-values-r">Sensitivity analysis excluding missing values (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>#read in original dataset
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>df_original &lt;- read.csv("/path/ISPY2_n985_TCIA_FTVdata_with_EFS_clinical_forN899.csv")
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>colnames(df_original)
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>#subset relevant vars (efs.time, efs.ind, FTV3)
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>df &lt;- df_original[,c(18, 19, 27, 29, 30)]
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>#summarize NA
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>x &lt;- df %&gt;% summarize_all(funs(sum(is.na(.))))
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>#x
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>result &lt;- df %&gt;% summarize_all(funs(sum(is.na(.)))) %&gt;%
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>  gather(key = "variable", value = "missing count") %&gt;%
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>  arrange(variable)
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>#result
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>#exclude missing from FTV3
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>df &lt;- na.exclude(df)
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>#log transformed ftv3
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>df$log_FTV3 &lt;- log(df$FTV3+1)
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>#cube root ftv3
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>df$cube_FTV3 &lt;- df$FTV3^(1/3)
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>#combined status
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>df$combined_status &lt;- ifelse(df$HR == 1 &amp; df$HER2 == 1, "HR+/HER2+",
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>                          ifelse(df$HR == 1, "HR+/HER2-",
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>                          ifelse(df$HER2 == 1, "HR-/HER2+", "HR-/HER2-")))
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>#make factor vars
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>df$HR &lt;- as.factor(df$HR)
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>df$HER2 &lt;- as.factor(df$HER2)
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>df$combined_status &lt;- as.factor(df$combined_status)
<a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>
<a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>table(df$combined_status, df$efs.ind)
<a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>table(df$combined_status)
<a id="__codelineno-5-37" name="__codelineno-5-37" href="#__codelineno-5-37"></a>table(df$HR, df$HER2)
<a id="__codelineno-5-38" name="__codelineno-5-38" href="#__codelineno-5-38"></a>set.seed(123456)
<a id="__codelineno-5-39" name="__codelineno-5-39" href="#__codelineno-5-39"></a>#make lists of predictor sets
<a id="__codelineno-5-40" name="__codelineno-5-40" href="#__codelineno-5-40"></a>predictor_lists &lt;- list(
<a id="__codelineno-5-41" name="__codelineno-5-41" href="#__codelineno-5-41"></a>  c("FTV3", "combined_status"),
<a id="__codelineno-5-42" name="__codelineno-5-42" href="#__codelineno-5-42"></a>  c("log_FTV3", "combined_status"),
<a id="__codelineno-5-43" name="__codelineno-5-43" href="#__codelineno-5-43"></a>  c("cube_FTV3", "combined_status")
<a id="__codelineno-5-44" name="__codelineno-5-44" href="#__codelineno-5-44"></a>)
<a id="__codelineno-5-45" name="__codelineno-5-45" href="#__codelineno-5-45"></a>
<a id="__codelineno-5-46" name="__codelineno-5-46" href="#__codelineno-5-46"></a>#set number of folds for cross-validation
<a id="__codelineno-5-47" name="__codelineno-5-47" href="#__codelineno-5-47"></a>num_folds &lt;- 5
<a id="__codelineno-5-48" name="__codelineno-5-48" href="#__codelineno-5-48"></a>
<a id="__codelineno-5-49" name="__codelineno-5-49" href="#__codelineno-5-49"></a>#create folds
<a id="__codelineno-5-50" name="__codelineno-5-50" href="#__codelineno-5-50"></a>folds &lt;- cvFolds(nrow(df), K = num_folds, type = "random")
<a id="__codelineno-5-51" name="__codelineno-5-51" href="#__codelineno-5-51"></a>
<a id="__codelineno-5-52" name="__codelineno-5-52" href="#__codelineno-5-52"></a>#initialize a list to store concordance indices for each model
<a id="__codelineno-5-53" name="__codelineno-5-53" href="#__codelineno-5-53"></a>c_indices_list &lt;- vector("list", length(predictor_lists))
<a id="__codelineno-5-54" name="__codelineno-5-54" href="#__codelineno-5-54"></a>
<a id="__codelineno-5-55" name="__codelineno-5-55" href="#__codelineno-5-55"></a>#cross-validation func
<a id="__codelineno-5-56" name="__codelineno-5-56" href="#__codelineno-5-56"></a>for(j in seq_along(predictor_lists)){
<a id="__codelineno-5-57" name="__codelineno-5-57" href="#__codelineno-5-57"></a>  c_indices &lt;- numeric(num_folds)
<a id="__codelineno-5-58" name="__codelineno-5-58" href="#__codelineno-5-58"></a>  for(i in 1:num_folds){
<a id="__codelineno-5-59" name="__codelineno-5-59" href="#__codelineno-5-59"></a>    #split the data into train/test sets for this fold
<a id="__codelineno-5-60" name="__codelineno-5-60" href="#__codelineno-5-60"></a>    train_indices &lt;- folds$subsets[folds$which != i]
<a id="__codelineno-5-61" name="__codelineno-5-61" href="#__codelineno-5-61"></a>    test_indices &lt;- folds$subsets[folds$which == i]
<a id="__codelineno-5-62" name="__codelineno-5-62" href="#__codelineno-5-62"></a>    df_train_fold &lt;- df[train_indices, ]
<a id="__codelineno-5-63" name="__codelineno-5-63" href="#__codelineno-5-63"></a>    df_test_fold &lt;- df[test_indices, ]
<a id="__codelineno-5-64" name="__codelineno-5-64" href="#__codelineno-5-64"></a>
<a id="__codelineno-5-65" name="__codelineno-5-65" href="#__codelineno-5-65"></a>    #fit cox model on training
<a id="__codelineno-5-66" name="__codelineno-5-66" href="#__codelineno-5-66"></a>    cox &lt;- coxph(as.formula(paste("Surv(efs.time, efs.ind) ~", paste(predictor_lists[[j]], collapse = " + "))), data = df_train_fold)
<a id="__codelineno-5-67" name="__codelineno-5-67" href="#__codelineno-5-67"></a>
<a id="__codelineno-5-68" name="__codelineno-5-68" href="#__codelineno-5-68"></a>    #calculate concordance index
<a id="__codelineno-5-69" name="__codelineno-5-69" href="#__codelineno-5-69"></a>    c_indices[i] &lt;- concordance(cox, newdata = df_test_fold)
<a id="__codelineno-5-70" name="__codelineno-5-70" href="#__codelineno-5-70"></a>  }
<a id="__codelineno-5-71" name="__codelineno-5-71" href="#__codelineno-5-71"></a>  #store concordance indices for this model
<a id="__codelineno-5-72" name="__codelineno-5-72" href="#__codelineno-5-72"></a>  c_indices_list[[j]] &lt;- list(c_indices)
<a id="__codelineno-5-73" name="__codelineno-5-73" href="#__codelineno-5-73"></a>}
<a id="__codelineno-5-74" name="__codelineno-5-74" href="#__codelineno-5-74"></a>
<a id="__codelineno-5-75" name="__codelineno-5-75" href="#__codelineno-5-75"></a>#calculate mean concordance index across all folds for each model
<a id="__codelineno-5-76" name="__codelineno-5-76" href="#__codelineno-5-76"></a>mean_concordance_list &lt;- sapply(c_indices_list, function(x) mean(unlist(x)))
<a id="__codelineno-5-77" name="__codelineno-5-77" href="#__codelineno-5-77"></a>mean_concordance_list
<a id="__codelineno-5-78" name="__codelineno-5-78" href="#__codelineno-5-78"></a>
<a id="__codelineno-5-79" name="__codelineno-5-79" href="#__codelineno-5-79"></a>#find the best model based on cv
<a id="__codelineno-5-80" name="__codelineno-5-80" href="#__codelineno-5-80"></a>best_model_index &lt;- which.max(mean_concordance_list)
<a id="__codelineno-5-81" name="__codelineno-5-81" href="#__codelineno-5-81"></a>best_model_predictors &lt;- predictor_lists[[best_model_index]]
<a id="__codelineno-5-82" name="__codelineno-5-82" href="#__codelineno-5-82"></a>
<a id="__codelineno-5-83" name="__codelineno-5-83" href="#__codelineno-5-83"></a>best_model_predictors
</code></pre></div>
<h2 id="time-dependent-roc-sas-proc-phreg-procedure">Time-Dependent ROC (SAS PROC PHREG procedure)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>options nodate nocenter orientation=landscape missing=' ';
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>%let odate=06072024;
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>*/libname d1 "C:\Users\kevin\OneDrive\Documents\Data Science\Projects\CAPSTONE\EXCEL" ;
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>libname db  "C:\Users\kevin\OneDrive\Documents\Data Science\Projects\CAPSTONE\SASfiles" ;
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>%let results= C:\Users\kevin\OneDrive\Documents\Data Science\Projects\CAPSTONE\SASresults;
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>%let pname=%sysget(SAS_EXECFILEPATH );  /*** capture name of program for footnote on output ***/
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>%put &amp;pname;
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>footnote1 "&amp;pname";
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>/*** Standard formats ***/
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>proc format;
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>     value meanblnk . = ' ' other = [10.3];
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>     value missint  . = ' ' other = [10.];
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>     value nblnk . = ' '    other = [10.];
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>     value missblnk . = ' ' other = [pvalue6.4];
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>     value yesno .= ' ' 0='NO' 1='YES';
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>     value HER2_HR 
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>        .=' '
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>        0='HR-/HER2-' 
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>        1='HR+/HER2-' 
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>        2='HR-/HER2+'
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>        3='HR+/HER2+';
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>run; 
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>/*  import dataset   */
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>proc import datafile="C:\Users\kevin\OneDrive\Documents\Data Science\Projects\CAPSTONE\cleaned_imputed_df_2.csv" 
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>    out=imputed dbms=csv replace;
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>   getnames=yes;
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>   GUESSINGROWS= 2147483647;
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>run;
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>/*
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>data imputed;
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>  set d1.Cleaned_imputed_df_cj;
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>run;
<a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>*/
<a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a>
<a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>ods listing;
<a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>proc freq data=imputed;
<a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>table HER2*HR/list missing;
<a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>run;
<a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>
<a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>/* feature engineering   */
<a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>data imputed2;
<a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a> set imputed (drop = combined_status);
<a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>    combined_status=.;*set missing to numeric variable;
<a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>    if HER2=0 and HR=0 then combined_status=0;
<a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>    if HER2=0 and HR=1 then combined_status=1;
<a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>    if HER2=1 and HR=0 then combined_status=2;
<a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>    if HER2=1 and HR=1 then combined_status=3;
<a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>     log_FTV3 =log( FTV3+1);
<a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>    cube_FTV3 = FTV3**(1/3);
<a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>    efs_time_years=efs_time /365.25;
<a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>    format combined_status HER2_HR.;
<a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a>run; 
<a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>
<a id="__codelineno-6-58" name="__codelineno-6-58" href="#__codelineno-6-58"></a>ods listing;
<a id="__codelineno-6-59" name="__codelineno-6-59" href="#__codelineno-6-59"></a>proc freq data=imputed2;
<a id="__codelineno-6-60" name="__codelineno-6-60" href="#__codelineno-6-60"></a>table HER2*HR*combined_status/list missing;
<a id="__codelineno-6-61" name="__codelineno-6-61" href="#__codelineno-6-61"></a>run;
<a id="__codelineno-6-62" name="__codelineno-6-62" href="#__codelineno-6-62"></a>/*                                                          Cumulative    Cumulative
<a id="__codelineno-6-63" name="__codelineno-6-63" href="#__codelineno-6-63"></a>
<a id="__codelineno-6-64" name="__codelineno-6-64" href="#__codelineno-6-64"></a>The FREQ Procedure
<a id="__codelineno-6-65" name="__codelineno-6-65" href="#__codelineno-6-65"></a>
<a id="__codelineno-6-66" name="__codelineno-6-66" href="#__codelineno-6-66"></a>                                                          Cumulative    Cumulative
<a id="__codelineno-6-67" name="__codelineno-6-67" href="#__codelineno-6-67"></a>HER2    HR    combined_status    Frequency     Percent     Frequency      Percent
<a id="__codelineno-6-68" name="__codelineno-6-68" href="#__codelineno-6-68"></a>
<a id="__codelineno-6-69" name="__codelineno-6-69" href="#__codelineno-6-69"></a>   0     0    HR-/HER2-               323       35.93           323        35.93
<a id="__codelineno-6-70" name="__codelineno-6-70" href="#__codelineno-6-70"></a>   0     1    HR+/HER2-               357       39.71           680        75.64
<a id="__codelineno-6-71" name="__codelineno-6-71" href="#__codelineno-6-71"></a>   1     0    HR-/HER2+                79        8.79           759        84.43
<a id="__codelineno-6-72" name="__codelineno-6-72" href="#__codelineno-6-72"></a>   1     1    HR+/HER2+               140       15.57           899       100.00
<a id="__codelineno-6-73" name="__codelineno-6-73" href="#__codelineno-6-73"></a>
<a id="__codelineno-6-74" name="__codelineno-6-74" href="#__codelineno-6-74"></a>
<a id="__codelineno-6-75" name="__codelineno-6-75" href="#__codelineno-6-75"></a>*/
<a id="__codelineno-6-76" name="__codelineno-6-76" href="#__codelineno-6-76"></a>
<a id="__codelineno-6-77" name="__codelineno-6-77" href="#__codelineno-6-77"></a>
<a id="__codelineno-6-78" name="__codelineno-6-78" href="#__codelineno-6-78"></a>ods listing;
<a id="__codelineno-6-79" name="__codelineno-6-79" href="#__codelineno-6-79"></a>proc contents data=imputed2 short;
<a id="__codelineno-6-80" name="__codelineno-6-80" href="#__codelineno-6-80"></a>run;
<a id="__codelineno-6-81" name="__codelineno-6-81" href="#__codelineno-6-81"></a>/*The SAS System                                                                                                                     6
<a id="__codelineno-6-82" name="__codelineno-6-82" href="#__codelineno-6-82"></a>
<a id="__codelineno-6-83" name="__codelineno-6-83" href="#__codelineno-6-83"></a>The CONTENTS Procedure
<a id="__codelineno-6-84" name="__codelineno-6-84" href="#__codelineno-6-84"></a>
<a id="__codelineno-6-85" name="__codelineno-6-85" href="#__codelineno-6-85"></a>                                           Alphabetic List of Variables for WORK.IMPUTED2
<a id="__codelineno-6-86" name="__codelineno-6-86" href="#__codelineno-6-86"></a>
<a id="__codelineno-6-87" name="__codelineno-6-87" href="#__codelineno-6-87"></a>Age_at_Screening Arm FTV0 FTV1 FTV2 FTV3 HER2 HR MP RESEARCH_ID 
<a id="__codelineno-6-88" name="__codelineno-6-88" href="#__codelineno-6-88"></a>Race RowID combined_status cube_FTV3 drfs_ind drfs_time efs_ind
<a id="__codelineno-6-89" name="__codelineno-6-89" href="#__codelineno-6-89"></a>efs_time efs_time_years ethnicity log_FTV3 menopausal_status 
<a id="__codelineno-6-90" name="__codelineno-6-90" href="#__codelineno-6-90"></a>os_ind os_time pCR patient_diagnosed_distant_progre
<a id="__codelineno-6-91" name="__codelineno-6-91" href="#__codelineno-6-91"></a>patient_diagnosed_local_progress survival_status__c 
<a id="__codelineno-6-92" name="__codelineno-6-92" href="#__codelineno-6-92"></a>time_to_last_followup
<a id="__codelineno-6-93" name="__codelineno-6-93" href="#__codelineno-6-93"></a>
<a id="__codelineno-6-94" name="__codelineno-6-94" href="#__codelineno-6-94"></a>*/
<a id="__codelineno-6-95" name="__codelineno-6-95" href="#__codelineno-6-95"></a>
<a id="__codelineno-6-96" name="__codelineno-6-96" href="#__codelineno-6-96"></a>
<a id="__codelineno-6-97" name="__codelineno-6-97" href="#__codelineno-6-97"></a>proc phreg data=imputed2  concordance plots=roc rocoptions(at=1, 2,  5 method = km);
<a id="__codelineno-6-98" name="__codelineno-6-98" href="#__codelineno-6-98"></a>    class combined_status;
<a id="__codelineno-6-99" name="__codelineno-6-99" href="#__codelineno-6-99"></a>   model efs_time_years*efs_ind(0)=log_FTV3 combined_status ;
<a id="__codelineno-6-100" name="__codelineno-6-100" href="#__codelineno-6-100"></a>   output out=imputed3  xbeta=Y_log;
<a id="__codelineno-6-101" name="__codelineno-6-101" href="#__codelineno-6-101"></a>run;
<a id="__codelineno-6-102" name="__codelineno-6-102" href="#__codelineno-6-102"></a>
<a id="__codelineno-6-103" name="__codelineno-6-103" href="#__codelineno-6-103"></a>proc phreg data=imputed3  concordance plots=roc rocoptions(at=1, 2,  5 method = km);
<a id="__codelineno-6-104" name="__codelineno-6-104" href="#__codelineno-6-104"></a>    class combined_status;
<a id="__codelineno-6-105" name="__codelineno-6-105" href="#__codelineno-6-105"></a>   model efs_time_years*efs_ind(0)=cube_FTV3  combined_status ;
<a id="__codelineno-6-106" name="__codelineno-6-106" href="#__codelineno-6-106"></a>   output out=imputed4 xbeta=Y_cube;
<a id="__codelineno-6-107" name="__codelineno-6-107" href="#__codelineno-6-107"></a>run;
<a id="__codelineno-6-108" name="__codelineno-6-108" href="#__codelineno-6-108"></a>
<a id="__codelineno-6-109" name="__codelineno-6-109" href="#__codelineno-6-109"></a>ods graphics on;
<a id="__codelineno-6-110" name="__codelineno-6-110" href="#__codelineno-6-110"></a>ods rtf file="&amp;results\Time_Dependent_ROC3k_&amp;odate..doc" style=listing bodytitle;
<a id="__codelineno-6-111" name="__codelineno-6-111" href="#__codelineno-6-111"></a>title "&amp;results\Time_Dependent_ROC3k_&amp;odate..doc";
<a id="__codelineno-6-112" name="__codelineno-6-112" href="#__codelineno-6-112"></a>title2 "1a. Time-Dependent ROC curves";
<a id="__codelineno-6-113" name="__codelineno-6-113" href="#__codelineno-6-113"></a>title3 "from the Cox model of efs_time_years";
<a id="__codelineno-6-114" name="__codelineno-6-114" href="#__codelineno-6-114"></a>title4 "with FTV3 and combined_status as predictors";
<a id="__codelineno-6-115" name="__codelineno-6-115" href="#__codelineno-6-115"></a>title5 "Using imputed data";
<a id="__codelineno-6-116" name="__codelineno-6-116" href="#__codelineno-6-116"></a>ods trace on;
<a id="__codelineno-6-117" name="__codelineno-6-117" href="#__codelineno-6-117"></a> proc phreg data=imputed4   plots(overlay=individual)=roc   rocoptions(at=1, 2, 5 method = km);
<a id="__codelineno-6-118" name="__codelineno-6-118" href="#__codelineno-6-118"></a>    class combined_status;
<a id="__codelineno-6-119" name="__codelineno-6-119" href="#__codelineno-6-119"></a>   model efs_time_years*efs_ind(0)= FTV3  combined_status / roclabel='FTV3+combined_status';
<a id="__codelineno-6-120" name="__codelineno-6-120" href="#__codelineno-6-120"></a>   roc  'FTV3+combined_status' FTV3  combined_status;
<a id="__codelineno-6-121" name="__codelineno-6-121" href="#__codelineno-6-121"></a>   roc 'log_FTV3+combined_status' pred=Y_log;
<a id="__codelineno-6-122" name="__codelineno-6-122" href="#__codelineno-6-122"></a>    roc 'cube_FTV3+combined_status' pred=Y_cube;
<a id="__codelineno-6-123" name="__codelineno-6-123" href="#__codelineno-6-123"></a>    *roccontrast reference ('FTV3+combined_status') / estimate e;
<a id="__codelineno-6-124" name="__codelineno-6-124" href="#__codelineno-6-124"></a>run;
<a id="__codelineno-6-125" name="__codelineno-6-125" href="#__codelineno-6-125"></a>
<a id="__codelineno-6-126" name="__codelineno-6-126" href="#__codelineno-6-126"></a>ods rtf close;
<a id="__codelineno-6-127" name="__codelineno-6-127" href="#__codelineno-6-127"></a>
<a id="__codelineno-6-128" name="__codelineno-6-128" href="#__codelineno-6-128"></a>
<a id="__codelineno-6-129" name="__codelineno-6-129" href="#__codelineno-6-129"></a>Ods listing;
<a id="__codelineno-6-130" name="__codelineno-6-130" href="#__codelineno-6-130"></a>
<a id="__codelineno-6-131" name="__codelineno-6-131" href="#__codelineno-6-131"></a>Ods trace on;
<a id="__codelineno-6-132" name="__codelineno-6-132" href="#__codelineno-6-132"></a>
<a id="__codelineno-6-133" name="__codelineno-6-133" href="#__codelineno-6-133"></a>   proc phreg data = imputed2 concordance NAMELEN=200;
<a id="__codelineno-6-134" name="__codelineno-6-134" href="#__codelineno-6-134"></a>
<a id="__codelineno-6-135" name="__codelineno-6-135" href="#__codelineno-6-135"></a>     class combined_status/param=ref;
<a id="__codelineno-6-136" name="__codelineno-6-136" href="#__codelineno-6-136"></a>
<a id="__codelineno-6-137" name="__codelineno-6-137" href="#__codelineno-6-137"></a>     model efs_time_years*efs_ind(0) = combined_status FTV3/risklimits=PL;
<a id="__codelineno-6-138" name="__codelineno-6-138" href="#__codelineno-6-138"></a>
<a id="__codelineno-6-139" name="__codelineno-6-139" href="#__codelineno-6-139"></a>    ods output ConvergenceStatus = _cs;
<a id="__codelineno-6-140" name="__codelineno-6-140" href="#__codelineno-6-140"></a>
<a id="__codelineno-6-141" name="__codelineno-6-141" href="#__codelineno-6-141"></a>     ods output FitStatistics = _fs;
<a id="__codelineno-6-142" name="__codelineno-6-142" href="#__codelineno-6-142"></a>
<a id="__codelineno-6-143" name="__codelineno-6-143" href="#__codelineno-6-143"></a>     ods output ParameterEstimates = _pe;
<a id="__codelineno-6-144" name="__codelineno-6-144" href="#__codelineno-6-144"></a>
<a id="__codelineno-6-145" name="__codelineno-6-145" href="#__codelineno-6-145"></a>       ods output ModelANOVA= _t3; 
<a id="__codelineno-6-146" name="__codelineno-6-146" href="#__codelineno-6-146"></a>
<a id="__codelineno-6-147" name="__codelineno-6-147" href="#__codelineno-6-147"></a>     ods output CensoredSummary = _cens;
<a id="__codelineno-6-148" name="__codelineno-6-148" href="#__codelineno-6-148"></a>
<a id="__codelineno-6-149" name="__codelineno-6-149" href="#__codelineno-6-149"></a>     ods output  Concordance= _Cd;
<a id="__codelineno-6-150" name="__codelineno-6-150" href="#__codelineno-6-150"></a>   run;
<a id="__codelineno-6-151" name="__codelineno-6-151" href="#__codelineno-6-151"></a>
<a id="__codelineno-6-152" name="__codelineno-6-152" href="#__codelineno-6-152"></a>   ods rtf file="&amp;results\Cox_Test.doc" style=listing bodytitle;
<a id="__codelineno-6-153" name="__codelineno-6-153" href="#__codelineno-6-153"></a>
<a id="__codelineno-6-154" name="__codelineno-6-154" href="#__codelineno-6-154"></a>title "&amp;results\Cox_Test.doc" ;
<a id="__codelineno-6-155" name="__codelineno-6-155" href="#__codelineno-6-155"></a>
<a id="__codelineno-6-156" name="__codelineno-6-156" href="#__codelineno-6-156"></a>title2 "Cox results";
<a id="__codelineno-6-157" name="__codelineno-6-157" href="#__codelineno-6-157"></a>
<a id="__codelineno-6-158" name="__codelineno-6-158" href="#__codelineno-6-158"></a>proc phreg data = imputed2 concordance NAMELEN=200;
<a id="__codelineno-6-159" name="__codelineno-6-159" href="#__codelineno-6-159"></a>
<a id="__codelineno-6-160" name="__codelineno-6-160" href="#__codelineno-6-160"></a>     class combined_status/param=ref;
<a id="__codelineno-6-161" name="__codelineno-6-161" href="#__codelineno-6-161"></a>
<a id="__codelineno-6-162" name="__codelineno-6-162" href="#__codelineno-6-162"></a>     model efs_time_years*efs_ind(0) = combined_status FTV3/risklimits=PL;
<a id="__codelineno-6-163" name="__codelineno-6-163" href="#__codelineno-6-163"></a>
<a id="__codelineno-6-164" name="__codelineno-6-164" href="#__codelineno-6-164"></a>    ods output ConvergenceStatus = _cs;
<a id="__codelineno-6-165" name="__codelineno-6-165" href="#__codelineno-6-165"></a>
<a id="__codelineno-6-166" name="__codelineno-6-166" href="#__codelineno-6-166"></a>     ods output FitStatistics = _fs;
<a id="__codelineno-6-167" name="__codelineno-6-167" href="#__codelineno-6-167"></a>
<a id="__codelineno-6-168" name="__codelineno-6-168" href="#__codelineno-6-168"></a>     ods output ParameterEstimates = _pe;
<a id="__codelineno-6-169" name="__codelineno-6-169" href="#__codelineno-6-169"></a>
<a id="__codelineno-6-170" name="__codelineno-6-170" href="#__codelineno-6-170"></a>       ods output ModelANOVA= _t3; 
<a id="__codelineno-6-171" name="__codelineno-6-171" href="#__codelineno-6-171"></a>
<a id="__codelineno-6-172" name="__codelineno-6-172" href="#__codelineno-6-172"></a>     ods output CensoredSummary = _cens;
<a id="__codelineno-6-173" name="__codelineno-6-173" href="#__codelineno-6-173"></a>
<a id="__codelineno-6-174" name="__codelineno-6-174" href="#__codelineno-6-174"></a>     ods output  Concordance= _Cd;
<a id="__codelineno-6-175" name="__codelineno-6-175" href="#__codelineno-6-175"></a>
<a id="__codelineno-6-176" name="__codelineno-6-176" href="#__codelineno-6-176"></a>     ods select ParameterEstimates ModelANOVA Concordance ;
<a id="__codelineno-6-177" name="__codelineno-6-177" href="#__codelineno-6-177"></a>
<a id="__codelineno-6-178" name="__codelineno-6-178" href="#__codelineno-6-178"></a>  run;
<a id="__codelineno-6-179" name="__codelineno-6-179" href="#__codelineno-6-179"></a>
<a id="__codelineno-6-180" name="__codelineno-6-180" href="#__codelineno-6-180"></a>
<a id="__codelineno-6-181" name="__codelineno-6-181" href="#__codelineno-6-181"></a>
<a id="__codelineno-6-182" name="__codelineno-6-182" href="#__codelineno-6-182"></a>ods rtf close;
</code></pre></div>
<h2 id="6-pairwise-comparisons-r">6 Pairwise comparisons (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>#"HR+/HER2+", "HR+/HER2-", "HR-/HER2+", "HR-/HER2-"
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>  #make HR-/HER2- reference group. 
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>df$combined_status &lt;- relevel(df$combined_status, ref = "HR-/HER2-")
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>cox_model &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3 + combined_status, data = df)
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>summary(cox_model) 
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>  #make HR+/HER2+ reference group
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>df$combined_status &lt;- relevel(df$combined_status, ref = "HR+/HER2+")
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>cox_model &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3 + combined_status, data = df)
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>summary(cox_model) 
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>  #make HR+/HER2- reference group
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>df$combined_status &lt;- relevel(df$combined_status, ref = "HR+/HER2-")
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>cox_model &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3 + combined_status, data = df)
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>summary(cox_model) 
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>  #make HR-/HER2+ reference group
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>df$combined_status &lt;- relevel(df$combined_status, ref = "HR-/HER2+")
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>cox_model &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3 + combined_status, data = df)
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>summary(cox_model) 
</code></pre></div>
<h2 id="anova-test-for-interactions-r">ANOVA test for interactions (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>#anova combined and combined w/ interaction
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>fit1 &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3 + combined_status, data = df)
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>fit2 &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3 + combined_status + cube_FTV3:combined_status, data = df) 
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>anova(fit1, fit2)
</code></pre></div>
<h2 id="subgroup-analysis-r">Subgroup analysis (R)</h2>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>#split data into subgroups based on categories in combined status
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>splits &lt;- split(df, f = df$combined_status)
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>  # $`HR-/HER2-`
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>df_1 &lt;- splits[[2]]
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>  # $`HR+/HER2-`
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>df_2 &lt;- splits[[1]]
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a>  # $`HR-/HER2+`
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a>df_3 &lt;- splits[[3]]
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>  # $`HR+/HER2+`
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>df_4 &lt;- splits[[4]]
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a>
<a id="__codelineno-9-13" name="__codelineno-9-13" href="#__codelineno-9-13"></a>#fit for HR-/HER2- subgroup
<a id="__codelineno-9-14" name="__codelineno-9-14" href="#__codelineno-9-14"></a>cox_1 &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3, data = df_1)
<a id="__codelineno-9-15" name="__codelineno-9-15" href="#__codelineno-9-15"></a>summary(cox_1)
<a id="__codelineno-9-16" name="__codelineno-9-16" href="#__codelineno-9-16"></a>
<a id="__codelineno-9-17" name="__codelineno-9-17" href="#__codelineno-9-17"></a>#fit for HR+/HER2- subgroup
<a id="__codelineno-9-18" name="__codelineno-9-18" href="#__codelineno-9-18"></a>cox_2 &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3, data = df_2)
<a id="__codelineno-9-19" name="__codelineno-9-19" href="#__codelineno-9-19"></a>summary(cox_2)
<a id="__codelineno-9-20" name="__codelineno-9-20" href="#__codelineno-9-20"></a>
<a id="__codelineno-9-21" name="__codelineno-9-21" href="#__codelineno-9-21"></a>#fit for HR-/HER2+ subgroup
<a id="__codelineno-9-22" name="__codelineno-9-22" href="#__codelineno-9-22"></a>cox_3 &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3, data = df_3)
<a id="__codelineno-9-23" name="__codelineno-9-23" href="#__codelineno-9-23"></a>summary(cox_3)
<a id="__codelineno-9-24" name="__codelineno-9-24" href="#__codelineno-9-24"></a>
<a id="__codelineno-9-25" name="__codelineno-9-25" href="#__codelineno-9-25"></a># fit for HR+/HER2+ subgroup
<a id="__codelineno-9-26" name="__codelineno-9-26" href="#__codelineno-9-26"></a>cox_4 &lt;- coxph(Surv(efs.time.years, efs.ind) ~ cube_FTV3, data = df_4)
<a id="__codelineno-9-27" name="__codelineno-9-27" href="#__codelineno-9-27"></a>summary(cox_4)
</code></pre></div></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>